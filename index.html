<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Obfuscator</title>
  <style>
    body { font-family: Arial, sans-serif; background:#0d0d0d; color:#f1f1f1; text-align:center; padding:20px; }
    textarea { width:90%; height:180px; margin:10px; padding:10px; font-size:14px; border-radius:8px; background:#1a1a1a; color:#0ff; }
    button { margin:5px; padding:10px 20px; border:none; border-radius:8px; cursor:pointer; font-size:14px; transition:0.2s; }
    button:hover { opacity:0.85; }
    .gen { background:#e91e63; color:#fff; }
    .copy { background:#2196f3; color:#fff; }
    .download { background:#4caf50; color:#fff; }
    select { margin:5px; padding:5px; border-radius:6px; background:#1a1a1a; color:#fff; border:1px solid #444; }
    h1 { color:#ff4081; }
  </style>
</head>
<body>
  <h1>✨ Lua Obfuscator ✨</h1>
  <p>Paste your Roblox Lua script below:</p>
  <textarea id="input" placeholder="Enter Lua script here..."></textarea><br>
  <label>Layers: </label>
  <select id="layerCount">
    <option value="1">1</option>
    <option value="3">3</option>
    <option value="5" selected>5</option>
    <option value="7">7</option>
    <option value="10">10</option>
  </select><br>
  <button class="gen" onclick="generate()">Obfuscate</button>
  <button class="copy" onclick="copyCode()">Copy</button>
  <button class="download" onclick="downloadCode()">Download</button>
  <h3>Obfuscated Output:</h3>
  <textarea id="output" readonly></textarea>

<script>
const WHITELIST = ["loadstring","game","Instance","workspace","script","math","string","table","pairs","ipairs"];

function encodeToCharList(s){
  const codes = [];
  for(let i=0;i<s.length;i++){
    codes.push(s.charCodeAt(i));
  }
  return codes.join(",");
}

function junkLine(){
  const a = Math.floor(Math.random()*9999);
  const b = Math.floor(Math.random()*9999);
  return "local _x" + a + " = " + b + " * " + (b%7+1) + "\n";
}

function buildLayers(payload, layers){
  let current = payload;
  for(let i=0;i<layers;i++){
    const codeList = encodeToCharList(current);
    let wrapper = "loadstring(string.char(" + codeList + "))()";

    let junk = "";
    const junkCount = Math.floor(Math.random()*3)+1;
    for(let j=0;j<junkCount;j++){ junk += junkLine(); }

    current = junk + wrapper;
  }
  return "--[[ Obfuscated by Diamond ]]--\n" + current;
}

function generate(){
  const input = document.getElementById("input").value;
  if(!input){ alert("Please paste your Lua script!"); return; }
  const layers = parseInt(document.getElementById("layerCount").value);
  const result = buildLayers(input, layers);
  document.getElementById("output").value = result;
}

function copyCode(){
  const out = document.getElementById("output");
  out.select();
  document.execCommand("copy");
  alert("Copied to clipboard!");
}

function downloadCode(){
  const out = document.getElementById("output").value;
  if(!out){ alert("Generate code first!"); return; }
  const randName = Math.floor(Math.random()*9999999) + ".lua";
  const blob = new Blob([out], { type: "text/plain" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = randName;
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}
</script>
</body>
  </html>
