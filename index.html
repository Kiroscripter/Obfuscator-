<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Diamond Obfuscator Max Compression + Junk Flood (Luau)</title>
<style>
body { background:#071023; color:#e6f7ff; font-family:ui-sans-serif,sans-serif; }
.wrap{ max-width:1080px; margin:auto; padding:20px; }
textarea{ width:100%; min-height:200px; background:#041226; color:#dff6ff; border-radius:8px; padding:10px; font-family:monospace; font-size:13px; }
pre.output{ background:#021122; padding:10px; border-radius:8px; overflow:auto; max-height:500px; }
.btn{ padding:8px 12px; margin:2px; border:none; border-radius:6px; cursor:pointer; background:#0b84d6; color:white; font-weight:600; }
.btn.secondary{ background:#071225; border:1px solid rgba(255,255,255,0.1); color:#9fbfda; }
.row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top:6px; }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>Diamond Obfuscator Max Compression + Junk Flood</h1>
    <div class="sub">All layers merged, ultra-safe one-liner, super-junk flood enabled</div>
    <div class="small">--[[obfed by Diamond obfuscator - Max Compression + Junk Flood]]</div>
  </header>

  <div class="grid">
    <div class="card">
      <strong>Input</strong>
      <textarea id="inputArea" placeholder="Paste your Luau code here..."></textarea>
      <div class="row">
        <button class="btn" id="obfBtn">Obfuscate</button>
        <button class="btn secondary" id="exampleBtn">Load Example</button>
        <label><input type="checkbox" id="oneLineChk"> One Liner</label>
        <label><input type="checkbox" id="safeModeChk" checked> Safe Mode</label>
        <label><input type="checkbox" id="junkFloodChk"> Super Junk Flood</label>
      </div>
      <div class="row">
        <div>Layers:</div>
        <select id="layerCount">
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3" selected>3</option>
          <option value="4">4</option>
          <option value="5">5</option>
        </select>
      </div>
    </div>

    <div class="card">
      <strong>Output</strong>
      <pre id="outArea" class="output"></pre>
      <div class="row">
        <button class="btn" id="copyBtn">Copy</button>
        <button class="btn" id="downloadBtn">Download</button>
      </div>
    </div>
  </div>
</div>

<script>
function rndId(len){len=len||8;const l="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let s="";for(let i=0;i<len;i++)s+=l[Math.floor(Math.random()*l.length)];return s;}
function toBytesUtf8(str){const out=[];for(let i=0;i<str.length;i++)out.push(str.charCodeAt(i));return out;}
function encodeNumbersFromString(str,key){return toBytesUtf8(str).map(b=>(b^key)&0xFF);}
function makeLayerVar(payload,key){const t=rndId(5),tmp=rndId(5),nums=encodeNumbersFromString(payload,key).join(",");return `local ${t}={${nums}};for i=1,#${t}do ${t}[i]=bit32.bxor(${t}[i],${key})end;local ${tmp}="";for i=1,#${t}do ${tmp}=${tmp}..string.char(${t}[i])end;${tmp}`;}
function makeJunk(){const fn=rndId(5),a=Math.floor(Math.random()*1000),b=Math.floor(Math.random()*1000),c=Math.floor(Math.random()*100);return `do local ${fn}=${a}+${b};${fn}=bit32.bxor(${fn},${c});end`;}
function makeFakeFunc(){const n=rndId(5),x=Math.floor(Math.random()*500),y=Math.floor(Math.random()*500);return `local function ${n}()local n=${x}+${y} return n end`;}

// Generates multiple junk lines if flood enabled
function generateJunkFlood(times){let junk="";for(let i=0;i<times;i++){junk+=makeJunk()+makeFakeFunc();}return junk;}

function generateMaxCompressed(src,layers,oneLine,safeMode,junkFlood){
  let code = src;
  for(let i=0;i<layers;i++){
    const key = Math.floor(Math.random()*200)+20;
    code = makeLayerVar(code,key);
    code = (junkFlood?generateJunkFlood(5):makeJunk()) + code;
  }

  const runner = rndId(5);
  let finalLua=`--[[obfed by Diamond obfuscator - Max Compression + Junk Flood]]
local __s=${code}
local function ${runner}(s)
  local ok,f = pcall(loadstring,s)
  if ok and type(f)=="function" then
    local suc,res = pcall(f)
    if not suc and ${safeMode} then error("Layer execution failed:"..tostring(res)) end
    if type(res)=="string" then return res,true else return res,false end
  elseif ${safeMode} then error("Loadstring failed:"..tostring(f)) end
end
for _=1,${layers+2} do
  local r,isStr = ${runner}(__s)
  if not r then break end
  if isStr then __s=r else return end
end
local ok2,f2 = pcall(loadstring,__s)
if not ok2 and ${safeMode} then error("Final loadstring failed:"..tostring(f2)) end
if type(f2)=="function" then pcall(f2) end`;

  if(oneLine) finalLua=finalLua.replace(/[\n\r]+/g," ").replace(/\s{2,}/g," ");
  return finalLua;
}

document.getElementById("obfBtn").onclick=()=>{
  const src=document.getElementById("inputArea").value;
  const layers=parseInt(document.getElementById("layerCount").value,10);
  const oneLine=document.getElementById("oneLineChk").checked;
  const safeMode=document.getElementById("safeModeChk").checked;
  const junkFlood=document.getElementById("junkFloodChk").checked;
  document.getElementById("outArea").textContent=generateMaxCompressed(src,layers,oneLine,safeMode,junkFlood);
};

document.getElementById("exampleBtn").onclick=()=>{document.getElementById("inputArea").value=`for i=1,3 do print("diamond",i) end`;}
document.getElementById("copyBtn").onclick=()=>{navigator.clipboard.writeText(document.getElementById("outArea").textContent).then(()=>alert("Copied!"));}
document.getElementById("downloadBtn").onclick=()=>{const blob=new Blob([document.getElementById("outArea").textContent],{type:"text/plain"});const a=document.createElement("a");a.href=URL.createObjectURL(blob);a.download=`diamond_${Date.now()}.lua`;a.click();setTimeout(()=>URL.revokeObjectURL(a.href),5000);}
</script>
</body>
</html>
